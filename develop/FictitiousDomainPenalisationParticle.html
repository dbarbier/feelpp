<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.1.2"/>
<title>Feel++: Penalty method to simulate particle flow in capillaries</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="feel.css"   rel="stylesheet" type="text/css" />
<link href="feel.css" rel="stylesheet" type="text/css">
<!-- $extrastylesheet -->
<script type="text/javascript" src="eigen_navtree_hacks.js"></script>
<!-- <script type="text/javascript"> -->
<!-- </script> -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <a name="top"></a> -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
    <div id="projectname"><a href="http://www.feelpp.org/"><img alt="Logo" src="feel_logo_small.png"/></a>
   &#160;<span id="projectnumber">0.93.0</span>
   </div>
   <div id="projectbrief">Finite Element Embedded Library and Language in C++</div>
  </td>
  <td width="500px" align="center" valign="bottom">
    <a href="http://www.feelpp.org/"><img alt="Feel++" src="home.png"/></a>
    <a href="https://github.com/feelpp/feelpp"><img alt="Feel++ on Github" src="http://sciactive.github.io/pnotify/includes/github-icon.png"/></a>
    <a href="https://plus.google.com/communities/104696212880173187475"><img alt="Feel++ community" src="google.png"/></a>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('FictitiousDomainPenalisationParticle.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Penalty method to simulate particle flow in capillaries </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#FictitiousDomainPenalisationParticle_Intro">Introduction</a></li>
<li class="level1"><a href="#FictitiousDomainPenalisationParticle_Model">Model and numerical method</a></li>
<li class="level1"><a href="#FictitiousDomainPenalisationParticle_Results">Numerical Results</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="FictitiousDomainPenalisationParticle_Intro"></a>
Introduction</h1>
<p>We propose a somewhat simple numerical method albeit used conjointly with physical experiments to understand particle flows in capillaries. Studies of flows in micro channels have been multiplied since several years because of the goal to create cheap and efficient lab-on-chips. An application that would like to achieve many groups with a good quality is the sorting of particles on lab-on-chips. For example sorting healthy / sick red blood cells. One of the building blocs of such microfluidic system is the splitting of a channel into two daughters channels. All the mechanisms involving the spreading of particles in such a system are not completely understood. It has been seen for example that, when a suspension of particles pass through a bifurcation having different flow rates at outlet, the branch having the higher flow rate see its volume fraction (concentration of particles) increase. This phenomenon is known as the {Zweifach - Fung effect} <b>[YuanCheng197334]</b>}.</p>
<p>In <a class="el" href="citelist.html#CITEREF_DOYEUX2011a">DOYEUX2011a</a>, the authors used <code>FreeFem++</code> to run a 2D simulation of a microfluidic bifurcation in which a rigid and circular particle is put in the inlet channel and goes to one of the outlet channels. The choice of the particle to go to the higher or the lower flow rate channel depends on many parameters which have been studied in the paper such as the flow rate ratio between the two branches, the size of the particle, the size of the outlet channels or even the angle between the inlet and the outlet channels. The simulations were compared with experiments and showed a good agreement. These simulations and experiments shown an attracting hydrodynamical force toward the lower flow rate channel which was unknown until there. Moreover the increase in concentration in the highest flow rate branch has been explained by a geometrical effect of the distribution of particles in the inlet channel which was a good step forward in the understanding of the <em>Zweifach-Fung</em> <code>effect</code>.</p>
<h1><a class="anchor" id="FictitiousDomainPenalisationParticle_Model"></a>
Model and numerical method</h1>
<p>We propose to implement the method used in <a class="el" href="citelist.html#CITEREF_DOYEUX2011a">DOYEUX2011a</a> and have both 2D and 3D setups which is readily the case using <code>Feel++</code>. Moreover, <code>Feel++</code> allows us to run the same simulation in 3D without re-coding.</p>
<p>The size of the channel is very small (typically <img class="formulaInl" alt="$\unit{60}{\micro\meter}$" src="form_275.png"/>), so that we can assume that we are in a low Reynolds number regime ( <img class="formulaInl" alt="$Re=10^{-1}$" src="form_276.png"/> in <a class="el" href="citelist.html#CITEREF_DOYEUX2011a">DOYEUX2011a</a>). The particles are rigid and spherical (circular in 2D) and for the sake of simplicity, we consider only one particle in the bifurcation. The extension to many particles can be done with no special care since the particles do not touch. This assumption is valid since we are interested in dilute suspension and in this case the hydrodynamic force is generally sufficient to prevent contacts.</p>
<p>Let's call <img class="formulaInl" alt="$\Omega_f$" src="form_277.png"/> the fluid domain, <img class="formulaInl" alt="$B$" src="form_267.png"/> the particle domain and <img class="formulaInl" alt="$\Omega = \Omega_f \cup B$" src="form_278.png"/> the whole domain. As explained above, the fluid is assumed to be governed by <a class="el" href="classFeel_1_1Stokes.html" title="solves the stokes equations">Stokes</a> equations</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray} - 2 \nu \nabla \cdot \bm{D(u)} + \nabla p &amp;=&amp; 0 \: \text{ in } \Omega_f, \label{eq:stokes_1}\\ \nabla \cdot \bm{u} &amp;=&amp; 0 \: \text{ in } \Omega_f, \label{eq:stokes_2} \\ \bm{u} &amp;=&amp; \bm{f} \: \text{ on } \partial \Omega_f\setminus\partial B, \label{eq:stokes_3} \end{eqnarray}" src="form_279.png"/>
</p>
<p>where : <img class="formulaInl" alt="$\bm{u}$" src="form_280.png"/> is the velocity of the fluid, <img class="formulaInl" alt="$\bm{D(u)} = \dfrac{\nabla \bm{u} + \nabla \bm{u}^T}{2}$" src="form_281.png"/> the deformation tensor, <img class="formulaInl" alt="$p$" src="form_282.png"/> is the pressure of the fluid and <img class="formulaInl" alt="$\bm{f}$" src="form_283.png"/> is a given function related to the boundary conditions on <img class="formulaInl" alt="$\partial\Omega$" src="form_284.png"/> (those on <img class="formulaInl" alt="$\partial B$" src="form_285.png"/> will be treated later by penalty). Moreover, we impose that the mean of the pressure is zero by adding a Lagrange multiplier <img class="formulaInl" alt="$\lambda$" src="form_286.png"/>. This approach allows us to use direct solvers such as UMFPack, MUMPS or PASTIX otherwise only iterative solvers would have been accessible. Thus, the variational formulation reads :</p>
<p>Find <img class="formulaInl" alt="$(\bm{u}, p, \lambda) \in H^1(\Omega_f)^2\times L^2_0(\Omega_f)\times\mathbb{R}$" src="form_287.png"/> such that <img class="formulaInl" alt="$\forall (\bm{v}, q, \mu) \in H^1(\Omega_f)^2\times L^2_0(\Omega_f)\times\mathbb{R}$" src="form_288.png"/> :</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray} 2 \nu \int_{\Omega_f} \bm{D(u)} : \bm{D(v)} - \int_{\Omega_f} p \nabla \cdot \bm{v} &amp;&amp;\nonumber\\ + \int_{\Omega_f} \lambda q &amp;=&amp; 0, \label{eq:varstokes_1}\\ \int_{\Omega_f} q \nabla \cdot \bm{u} &amp;=&amp; 0, \label{eq:varstokes_2} \\ \int_{\Omega_f} \mu p &amp;=&amp; 0, \label{eq:varstokes_4}\\ \bm{u} &amp;=&amp; \bm{f} \: \text{ on } \partial \Omega. \label{eq:varstokes_3}\nonumber \end{eqnarray}" src="form_289.png"/>
</p>
<p>and the corresponding  code is given by the listing listing_stokes}.</p>
<p>The particle is taken into account following <a class="el" href="citelist.html#CITEREF_Janela2005">Janela2005</a> in which, one imposes a rigid-body constraint by a penalty method. From the physics point of view, this method consists to consider the particle as a part of the fluid with a ``huge viscosity'' and constrained to have a rigid-body motion. Thus, instead of integrating in the fluid domain <img class="formulaInl" alt="$\Omega_f$" src="form_277.png"/>, we rewrite our variational formulation in the whole domain <img class="formulaInl" alt="$\Omega$" src="form_210.png"/> while taking into account the following constraint</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \bm{D(u)} = 0, \: \text{ in } B. \label{eq:rigidbody} \]" src="form_290.png"/>
</p>
<p>This rigid-body constraint {eq:rigidbody} is added to equation {eq:varstokes_1} using a small enough penalty coefficient <img class="formulaInl" alt="$\varepsilon$" src="form_291.png"/>. Finally the new variational formulation reads</p>
<p>Find <img class="formulaInl" alt="$(\bm{u},p, \lambda) \in H^1(\Omega)^2 \times L^2_0(\Omega) \times \mathbb{R}$" src="form_292.png"/> such that <img class="formulaInl" alt="$\forall (\bm{v}, q, \mu) \in H^1(\Omega)^2 \times L^2_0(\Omega) \times \mathbb{R}$" src="form_293.png"/> :</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray} 2 \nu \int_{\Omega} \bm{D(u)} : \bm{D(v)} - \int_{\Omega} p \nabla \cdot \bm{v} &amp;&amp; \nonumber\\ +\int_{\Omega} \lambda q + \frac{2}{\varepsilon} \int_B \chi ( \bm{D(u)} : \bm{D(v)} ) &amp;=&amp; 0, \label{eq:varstokespenal_1}\\ \int_{\Omega} q \nabla \cdot \bm{u} &amp;=&amp; 0, \label{eq:varstokespenal_2} \\ \int_{\Omega} \mu p &amp;=&amp; 0, \label{eq:varstokespenal_4}\\ \bm{u} &amp;=&amp; \bm{f} \: \text{ on } \partial \Omega. \label{eq:varstokespenal_3}\nonumber \end{eqnarray}" src="form_294.png"/>
</p>
<p>Note that the integral over <img class="formulaInl" alt="$B$" src="form_267.png"/> is performed by integrating over <img class="formulaInl" alt="$\Omega$" src="form_210.png"/> while multiplying by the characteristic function <img class="formulaInl" alt="$\chi$" src="form_295.png"/> (see listing listing_penalty}). In practice, only the penalty term changes during time and has to be reassembled (e.g. the last term in equation {eq:varstokespenal_1}). Thus, only the penalty term is added to the whole problem at each iteration. Moreover, this term does vanishes on most elements of the mesh and instead of integrating the penalty term over all the elements and multiplying by <img class="formulaInl" alt="$\chi$" src="form_295.png"/>, we only integrate on those crossed by <img class="formulaInl" alt="$\chi$" src="form_295.png"/> using a special feature <code>broken()</code> of <code><a class="el" href="namespaceFeel.html#a4c300b4c137594540a9428af36363049" title="integrate a polynomial over a convex">integrate()</a></code> to localize these elements, see section~<a class="el" href="Integrals.html">Integrations, Operators and Norms</a>.</p>
<p>Finally, we introduce the time step <img class="formulaInl" alt="$\Delta t$" src="form_296.png"/> and we denote by <img class="formulaInl" alt="$(\bm{u}_n,p_n,\lambda_n)$" src="form_297.png"/> the solution of the system {eq:varstokespenal_1}-{eq:varstokespenal_2}-{eq:varstokespenal_4} at time <img class="formulaInl" alt="$t_n=n\Delta t$" src="form_298.png"/>. The velocity of the particle denoted by <img class="formulaInl" alt="$\bm{V}_n$" src="form_299.png"/> is then calculated by the relation {eq:velocitypart} and its position <img class="formulaInl" alt="$\bm{X}_n$" src="form_300.png"/> by the relation {eq:positionpart}.</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray} \bm{V}_n &amp;=&amp; \frac{1}{\int_{\Omega} \chi} \int_{\Omega} \chi \, \bm{u}_n, \label{eq:velocitypart}\\ \bm{X}_{n+1} &amp;=&amp; \bm{X}_{n} + \Delta t \bm{V}_n, \label{eq:positionpart} \end{eqnarray}" src="form_301.png"/>
</p>
<h1><a class="anchor" id="FictitiousDomainPenalisationParticle_Results"></a>
Numerical Results</h1>
<p>Figure shows a 2D simulation of a particle entering in the low flow rate branch while figures and display the results of the 3D simulation.</p>
<center> <table  border="0px">
<tr>
<td style="width:30%"><div class="image">
<img src="bift_001" alt="bift_001"/>
<div class="caption">
t=0.01</div></div>
 </td><td style="width:30%"><div class="image">
<img src="bift_120" alt="bift_120"/>
<div class="caption">
t=1.20</div></div>
 </td><td style="width:30%"><div class="image">
<img src="bift_260" alt="bift_260"/>
<div class="caption">
t=2.60</div></div>
  </td></tr>
<tr>
<td><center>2D simulation of a particle entering in the low flow rate channel.</center>  <table class="doxtable">
</table>
<table  border="0px">
<tr>
<td width="15%"><div class="image">
<img src="bif_vecteurs.png" alt="bif_vecteurs.png"/>
</div>
  </td></tr>
<tr>
<td><center>3D simulation of the bifurcation problem. The velocity vectors are plotted and colored by the velocity magnitude. </center>  </td></tr>
</table>
</td></tr>
</table>
</center></div></div><!-- contents -->
</div><!-- doc-content -->
<hr size="1"><address style="text-align: right;"><small>
Generated on Sat Jun 15 2013 00:07:22 for Feel++ by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.8.1.2</small></address>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-40726726-1', 'github.io');
  ga('send', 'pageview');
</script>
</body>
</html>
