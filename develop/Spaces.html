<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.1.2"/>
<title>Feel++: Function Spaces</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="feel.css"   rel="stylesheet" type="text/css" />
<link href="feel.css" rel="stylesheet" type="text/css">
<!-- $extrastylesheet -->
<script type="text/javascript" src="eigen_navtree_hacks.js"></script>
<!-- <script type="text/javascript"> -->
<!-- </script> -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <a name="top"></a> -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
    <div id="projectname"><a href="http://www.feelpp.org/"><img alt="Logo" src="feel_logo_small.png"/></a>
   &#160;<span id="projectnumber">0.94.0</span>
   </div>
   <div id="projectbrief">Finite Element Embedded Library and Language in C++</div>
  </td>
  <td width="500px" align="center" valign="bottom">
    <a href="http://www.feelpp.org/"><img alt="Feel++" src="home.png"/></a>
    <a href="https://github.com/feelpp/feelpp"><img alt="Feel++ on Github" src="http://sciactive.github.io/pnotify/includes/github-icon.png"/></a>
    <a href="https://plus.google.com/communities/104696212880173187475"><img alt="Feel++ community" src="google.png"/></a>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('Spaces.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Function Spaces </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#QRFunctionSpace">Function Space</a></li>
<li class="level1"><a href="#QRFunctionSpaceFn">Function Space helper functions</a></li>
</ul>
</div>
<div class="textblock"><ul>
<li><b>Previous:</b> <a class="el" href="Mesh.html">Meshes</a> </li>
<li><b>Next:</b> <a class="el" href="Integrals.html">Integrations, Operators and Norms</a></li>
</ul>
<hr/>
<h1><a class="anchor" id="QRFunctionSpace"></a>
Function Space</h1>
<p>We now turn to the next crucial mathematical ingredient: the function space, whose definition depends on <img class="formulaInl" alt="$\Omega_h$" src="form_559.png"/> &mdash; or more precisely its partitioning <img class="formulaInl" alt="$\calT_h$" src="form_547.png"/> &mdash; and the choice of basis function. Function spaces in  follow the same definition, see listing~fspace1}, and  provides support for continuous and discontinuous Galerkin methods and in particular approximations in <img class="formulaInl" alt="$L^2$" src="form_516.png"/>, <img class="formulaInl" alt="$H^1$" src="form_720.png"/>-conforming and <img class="formulaInl" alt="$H^1$" src="form_720.png"/>-nonconforming, <img class="formulaInl" alt="$H^2$" src="form_721.png"/>, <img class="formulaInl" alt="$H(\mathrm{div})$" src="form_722.png"/> and <img class="formulaInl" alt="$H(\mathrm{curl})$" src="form_723.png"/>{At the time of writing, <img class="formulaInl" alt="$H^2$" src="form_721.png"/>, <img class="formulaInl" alt="$H(\mathrm{div})$" src="form_722.png"/> and <img class="formulaInl" alt="$H(\mathrm{curl})$" src="form_723.png"/> approximations are in experimental support.}.</p>
<div class="fragment"><div class="line"><span class="comment">// space of continuous piecewise</span></div>
<div class="line"><span class="comment">// \f$\P_3\f$ functions defined on a mesh</span></div>
<div class="line"><span class="comment">// of order 2 triangles in 3D</span></div>
<div class="line">FunctionSpace&lt;Mesh&lt;Simplex&lt;2,2,3&gt;,</div>
<div class="line">              bases&lt;Lagrange&lt;3&gt; &gt; &gt; Xh;</div>
</div><!-- fragment --><p>The <code><a class="el" href="classFeel_1_1FunctionSpace.html">FunctionSpace</a></code> class</p>
<ul>
<li>constructs the table of degrees of freedom which maps local (elementwise) degrees of freedom to the global ones with respect to the geometrical entities,</li>
<li>embeds the definition of the elements of the function space allowing for a tight coupling between the elements and their function spaces,</li>
<li>stores an interpolation data structure ( region tree) for rapid localisation of point sets (determining in which element they reside).</li>
</ul>
<p>We introduce the following spaces </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \begin{aligned} \mathbb{W}_h &amp;= \{v_h \in L^2(\Omega_h): \ \forall K \in \mathcal{T}_h, v_h|_K \in \mathbb{P}_K\},\\ \mathbb{V}_h &amp;= \mathbb{W}_h \cap C^0(\Omega_h)= \{ v_h \in \mathbb{W}_h: \ \forall F \in \mathcal{F}^i_h\ \jump{v_h}_F = 0\}\\ \mathbb{H}_h &amp;= \mathbb{W}_h \cap C^1(\Omega_h)= \{ v_h \in \mathbb{W}_h: \ \forall F \in \mathcal{F}^i_h\ \jump{v_h}_F = \jump{\nabla v_h}_F = 0\}\\ \CR_h &amp;= \{ v_h \in L^2(\Omega_h):\ \forall K \in \calT_h, v_h|_K \in \P_1; \forall F \in \calF^i_h\ \int_F \jump{v_h} = 0 \}\\ \RaTu_h &amp;= \{ v_h \in L^2(\Omega_h):\ \forall K \in \calT_h, v_h|_K \in \Span{1,x,y,x^2-y^2}; \forall F \in \calF^i_h\ \int_F \jump{v_h} = 0 \}\\ \RT_h&amp;=\{\bm{v}_h \in [L^2(\Omega_h)]^d:\ \forall K \in \calT_h, v_h|_K \in \RT_k; \forall F \in \calF^i_h\ \jump{\bm{v}_h \cdot \normal}_F = 0 \}\\ \N_h&amp;=\{\bm{v}_h \in [L^2(\Omega_h)]^d:\ \forall K \in \calT_h, v_h|_K \in \N_k; \forall F \in \calF^i_h\ \jump{\bm{v}_h \times \normal}_F = 0 \} \end{aligned} \]" src="form_724.png"/>
</p>
<p> where <img class="formulaInl" alt="$\RT_k$" src="form_725.png"/> and <img class="formulaInl" alt="$\N_k$" src="form_726.png"/> are respectively the Raviart-Thomas and N\'ed\'elec finite elements of degree <img class="formulaInl" alt="$k$" src="form_727.png"/>.</p>
<p>The Legrendre and <a class="el" href="classFeel_1_1Dubiner.html" title="Dubiner polynomial orthonormal basis.">Dubiner</a> basis yield implicitely discontinuous approximations, the <a class="el" href="classFeel_1_1Legendre.html" title="Legendre polynomial orthonormal basis.">Legendre</a> and <a class="el" href="classFeel_1_1Dubiner.html" title="Dubiner polynomial orthonormal basis.">Dubiner</a> boundary adapted basis, see~<a class="el" href="citelist.html#CITEREF_MR1696933">MR1696933</a>, were designed to handle continuous approximations whereas the Lagrange basis can yield either discontinuous or continuous (default behavior) approximations. <img class="formulaInl" alt="$\RT_h$" src="form_728.png"/> and <img class="formulaInl" alt="$\N_h$" src="form_729.png"/> are implicitely spaces of vectorial functions <img class="formulaInl" alt="$\bm{f}$" src="form_283.png"/>  <img class="formulaInl" alt="$\bm{f}: \Omega_h \subset \R^d \mapsto \R^d$" src="form_730.png"/>. As to the other basis functions,  Lagrange, Legrendre, <a class="el" href="classFeel_1_1Dubiner.html" title="Dubiner polynomial orthonormal basis.">Dubiner</a>, , they are parametrized by their values namely <code><a class="el" href="structFeel_1_1Scalar.html">Scalar</a></code> , <code><a class="el" href="structFeel_1_1Vectorial.html">Vectorial</a></code> or <code>Matricial</code>. Note that <code><a class="el" href="classFeel_1_1FunctionSpace.html">FunctionSpace</a></code> handles also products of function spaces. This is very powerful to describe complex multiphysics problems when coupled with operators, functionals and forms described in the next section. Extracting subspaces or component spaces are part of the interface.</p>
<div class="fragment"><div class="line"><span class="comment">// continuous piecewise P3</span></div>
<div class="line"><span class="comment">// approximations</span></div>
<div class="line">FunctionSpace&lt;Mesh&lt;Simplex&lt;2&gt; &gt;,</div>
<div class="line">  bases&lt;Lagrange&lt;3,Scalar,</div>
<div class="line">                 Continuous&gt; &gt; &gt; P3ch;</div>
<div class="line"><span class="comment">// discontinuous piecewise P3</span></div>
<div class="line"><span class="comment">// approximations</span></div>
<div class="line">FunctionSpace&lt;Mesh&lt;Simplex&lt;2&gt; &gt;,</div>
<div class="line">  bases&lt;Lagrange&lt;3,Scalar,</div>
<div class="line">                 Discontinuous&gt; &gt; &gt; P3dh;</div>
<div class="line"><span class="comment">// mixed (P2 vectorial, P1 scalar,</span></div>
<div class="line"><span class="comment">// P1 Scalar) approximation</span></div>
<div class="line">FunctionSpace&lt;Mesh&lt;Simplex&lt;2&gt;&gt;,</div>
<div class="line"> bases&lt;Lagrange&lt;2,Vectorial&gt;,</div>
<div class="line">       Lagrange&lt;1,Scalar&gt;,</div>
<div class="line">       Lagrange&lt;1,Scalar&gt;&gt;&gt; P2P1P1;</div>
</div><!-- fragment --><p>The most important feature in <code><a class="el" href="classFeel_1_1FunctionSpace.html">FunctionSpace</a></code> is that it embeds the definition of element which allows for the strict definition of an <code>Element</code> of a <code><a class="el" href="classFeel_1_1FunctionSpace.html">FunctionSpace</a></code> and thus ensures the correctness of the code. An element has its representation as a vector &mdash; also in the case of product of multiple spaces. &mdash; The vector representation is parametrized by one of the linear algebra backends. Other supported operations are interpolation and extraction of components &mdash; be it a product of function spaces element or a vectorial/matricial element:</p>
<div class="fragment"><div class="line">FunctionSpace&lt;Mesh&lt;Simplex&lt;2&gt; &gt;,</div>
<div class="line">  bases&lt;Lagrange&lt;3,Scalar, Continuous&gt; &gt; &gt; P3ch;</div>
<div class="line"><span class="comment">// get an element from P3ch</span></div>
<div class="line"><span class="keyword">auto</span> u = P3ch.element();</div>
<div class="line">FunctionSpace&lt;Mesh&lt;Simplex&lt;2&gt; &gt;,</div>
<div class="line"> bases&lt;Lagrange&lt;2,Vectorial&gt;, Lagrange&lt;1,Scalar&gt;,</div>
<div class="line">       Lagrange&lt;1,Scalar&gt; &gt; &gt; P2P1P1;</div>
<div class="line"><span class="keyword">auto</span> U = P2P1P1.element();</div>
<div class="line"><span class="comment">// Views: changing a view changes U and vice versa</span></div>
<div class="line"><span class="comment">// view on element associated to P2</span></div>
<div class="line"><span class="keyword">auto</span> u = U.element&lt;0&gt;();</div>
<div class="line"><span class="comment">// extract view of first component</span></div>
<div class="line"><span class="keyword">auto</span> ux = u.comp(X);</div>
<div class="line"><span class="comment">// view on element associated to 1st P1</span></div>
<div class="line"><span class="keyword">auto</span> p = U.element&lt;1&gt;();</div>
<div class="line"><span class="comment">// view on element associated to 2nd P1</span></div>
<div class="line"><span class="keyword">auto</span> q = U.element&lt;2&gt;();</div>
</div><!-- fragment --><p>Finally Feel++ provides the Lagrange, <img class="formulaInl" alt="$\Iclag, \Idlag$" src="form_731.png"/>, Crouzeix-Raviart, <img class="formulaInl" alt="$\Icr$" src="form_732.png"/>, Raviart-Thomas, <img class="formulaInl" alt="$\Irt$" src="form_733.png"/> and N\'ed\'elec, <img class="formulaInl" alt="$\In$" src="form_734.png"/> global interpolation operators. In abstract form, they read </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \calI : \X \ni v \mapsto \sum_{i=1}^{\opdim\X} \ell_i(v) \phi_i \]" src="form_735.png"/>
</p>
<p> where <img class="formulaInl" alt="$\X$" src="form_736.png"/> is the infinite dimensional space, <img class="formulaInl" alt="$(\ell_i)_{i=1,...,\opdim\X}$" src="form_737.png"/> are the linear forms and <img class="formulaInl" alt="$(\phi_i)_{i=1...\opdim\X}$" src="form_738.png"/> the basis function associated with the various approximations.</p>
<h1><a class="anchor" id="QRFunctionSpaceFn"></a>
Function Space helper functions</h1>
<ul>
<li><code>Pch&lt;N&gt;(mesh)</code> generates <img class="formulaInl" alt="$\Pch[N](\Omega_h)$" src="form_739.png"/></li>
<li><code>Pchv&lt;N&gt;(mesh)</code> generates <img class="formulaInl" alt="$[\Pch[N](\Omega_h)]^d$" src="form_740.png"/></li>
<li><code>THch&lt;N&gt;(mesh)</code> generates <img class="formulaInl" alt="$[\Pch[N](\Omega_h)]^d\times \Pch[N](\Omega_h)$" src="form_741.png"/></li>
</ul>
<p><a href="#" class="top">top</a> <hr/>
 </div></div><!-- contents -->
</div><!-- doc-content -->
<hr size="1"><address style="text-align: right;"><small>
Generated on Wed Jul 3 2013 00:07:15 for Feel++ by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.8.1.2</small></address>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-40726726-1', 'github.io');
  ga('send', 'pageview');
</script>
</body>
</html>
