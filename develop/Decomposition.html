<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.4"/>
<title>Feel++: Domain Decomposition Methods</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="feel.css"   rel="stylesheet" type="text/css" />
<link href="feel.css" rel="stylesheet" type="text/css">
<!--  -->
<script type="text/javascript" src="eigen_navtree_hacks.js"></script>
<!-- <script type="text/javascript"> -->
<!-- </script> -->
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<!-- <a name="top"></a> -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
    <div id="projectname"><a href="http://www.feelpp.org/"><img alt="Logo" src="feel_logo_small.png"/></a>
   &#160;<span id="projectnumber">0.96.0-alpha.1+git26dc228</span>
   </div>
   <div id="projectbrief">Finite Element Embedded Library and Language in C++</div>
  </td>
  <td width="500px" align="center" valign="bottom">
    <a href="http://www.feelpp.org/"><img alt="Feel++" src="home.png"/></a>
    <a href="https://github.com/feelpp/feelpp"><img alt="Feel++ on Github" src="http://sciactive.github.io/pnotify/includes/github-icon.png"/></a>
    <a href="https://plus.google.com/communities/104696212880173187475"><img alt="Feel++ community" src="google.png"/></a>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.4 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('Decomposition.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Namespaces</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Friends</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(10)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(11)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(12)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Domain Decomposition Methods </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#Introduction">Introduction</a></li>
<li class="level1"><a href="#D1">A 1D Model</a><ul><li class="level2"><a href="#D1_Schwartz">Schwartz Algorithms</a></li>
<li class="level2"><a href="#D1_Variational">Variational formulations</a></li>
</ul>
</li>
<li class="level1"><a href="#Overlapping">A 2 domain overlapping Schwartz method in 2D and 3D</a><ul><li class="level2"><a href="#Overlapping_Schwartz">Schwartz algorithms</a></li>
<li class="level2"><a href="#Overlapping_Variational">Variational formulations</a><ul><li class="level3"><a href="#Overlapping_Implementation">Implementation</a></li>
</ul>
</li>
<li class="level2"><a href="#Overlapping_Numerical">Numerical results in 2D case</a></li>
<li class="level2"><a href="#Overlapping_Solutions">Numerical Solutions in 2D Case</a></li>
</ul>
</li>
<li class="level1"><a href="#Computing">Computing the eigenmodes of the Dirichlet to Neumann operator</a><ul><li class="level2"><a href="#Computing_Description">Problem description and variational formulation</a></li>
<li class="level2"><a href="#Computing_Implementation">Implementation</a></li>
<li class="level2"><a href="#Computing_Solutions">Numerical solutions</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><dl class="section author"><dt>Author</dt><dd>By Abdoulaye Samake </dd>
<dd>
Vincent Chabannes </dd>
<dd>
Christophe Prudâ€™homme</dd></dl>
<p><br/>
 </p>
<hr/>
<p> <br/>
</p>
<h1><a class="anchor" id="Introduction"></a>
Introduction</h1>
<p>In mathematics, numerical analysis, and numerical partial differential equations, domain decomposition methods solve a boundary value problem by splitting it into smaller boundary value problems on subdomains and iterating to coordinate the solution between the adjacent subdomains. A corse problem with one or fiew unknows per subdomain is used to further coordinate the solution between the subdomains globally.</p>
<h1><a class="anchor" id="D1"></a>
A 1D Model</h1>
<p>We consider the following laplacian boundary value problem </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \left \{ \begin{aligned} &amp; -u&quot;(x) = f(x) \quad \text{in} \quad ]0,1[ \\ &amp; u(0) =\alpha, ~ u(1) = \beta \end{aligned} \right. \label{eq:30} \end{equation}" src="form_227.png"/>
</p>
<p>where <img class="formulaInl" alt="$\alpha, \beta \in \mathbb R.$" src="form_228.png"/></p>
<h2><a class="anchor" id="D1_Schwartz"></a>
Schwartz Algorithms</h2>
<p>The schwartz overlapping multiplicative algorithm with dirichlet interface conditions for this problem at <img class="formulaInl" alt="$n^{th}$" src="form_229.png"/> iteration is given by </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:31} \left \{ \begin{aligned} -u_1&quot;^n(x) &amp; = f(x) \quad \text{in} \quad ]0,b[ \\ u_1^n(0) &amp; = \alpha \\ u_1^n(b) &amp; = u_2^{n-1}(b) \end{aligned} \right. \qquad \text{and} \qquad \left \{ \begin{aligned} -u_2&quot;^n(x) &amp; = f(x) \quad \text{in} \quad ]a,1[ \\ u_2^n(1) &amp; = \beta \\ u_2^n(a) &amp; = u_1^n(a) \end{aligned} \right. \end{equation}" src="form_230.png"/>
</p>
<p>where <img class="formulaInl" alt="$ n \in \mathbb N^*, a, b \in \mathbb R $" src="form_231.png"/> and <img class="formulaInl" alt="$a < b$" src="form_232.png"/>. <br/>
 Let <img class="formulaInl" alt="$e_i^n = u_i^n-u~(i=1,2)$" src="form_233.png"/>, the error at <img class="formulaInl" alt="$n^{th}$" src="form_229.png"/> iteration relative to the exact solution, the convergence rate is given by </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \rho = \frac{\vert e_1^n \vert}{\vert e_1^{n-1} \vert} = \frac{a}{b}\frac{1-b}{1-a} = \frac{\vert e_2^n \vert}{\vert e_2^{n-1} \vert} . \label{eq:32} \end{equation}" src="form_234.png"/>
</p>
<h2><a class="anchor" id="D1_Variational"></a>
Variational formulations</h2>
<p>find <img class="formulaInl" alt="$u$" src="form_235.png"/> such that </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation*} \int_0^b u_1'v' = \int_0^b fv \quad \forall v \qquad \text{in the first subdomain} ~\Omega_1 = ]0,b[ \end{equation*}" src="form_236.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation*} \int_a^1 u_2'v' = \int_a^1 fv \quad \forall v \qquad \text{in the second subdomain} ~ \Omega_2 = ]a,1[ \end{equation*}" src="form_237.png"/>
</p>
<h1><a class="anchor" id="Overlapping"></a>
A 2 domain overlapping Schwartz method in 2D and 3D</h1>
<p>We consider the following laplacian boundary value problem </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \left \{ \begin{aligned} -\Delta u &amp; = f \quad \text{in} \quad \Omega \\ u &amp; = g \quad \text{on} \quad \partial\Omega \end{aligned} \right. \label{eq:33} \end{equation}" src="form_238.png"/>
</p>
<p> where <img class="formulaInl" alt="$\Omega \subset \mathbb R^d, d=2,3$" src="form_239.png"/> and <img class="formulaInl" alt="$g$" src="form_114.png"/> is the dirichlet boundary value.</p>
<h2><a class="anchor" id="Overlapping_Schwartz"></a>
Schwartz algorithms</h2>
<p>The schwartz overlapping multiplicative algorithm with dirichlet interface conditions for this problem on two subdomains <img class="formulaInl" alt="$\Omega_1$" src="form_240.png"/> and <img class="formulaInl" alt="$\Omega_2$" src="form_241.png"/> at <img class="formulaInl" alt="$n^{th}$" src="form_229.png"/> iteration is given by </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:34} \left \{ \begin{aligned} -\Delta u_1^n &amp; = f \quad \qquad \text{in} \quad \Omega_1 \\ u_1^n &amp; = g \quad \qquad \text{on} \quad \partial \Omega_1^{ext}\\ u_1^n &amp; = u_2^{n-1} \quad ~~ \text{on} \quad \Gamma_1 \end{aligned} \right. \qquad \text{and} \qquad \left \{ \begin{aligned} - \Delta u_2^n &amp; = f \quad \qquad \text{in} \quad \Omega_2 \\ u_2^n &amp; = g \quad \qquad \text{on} \quad \partial \Omega_2^{ext}\\ u_2^n &amp; = u_1^n \qquad~~ \text{on} \quad \Gamma_2 \end{aligned} \right. \end{equation}" src="form_242.png"/>
</p>
<h2><a class="anchor" id="Overlapping_Variational"></a>
Variational formulations</h2>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation*} \begin{aligned} \int_{\Omega_i} \nabla u_i \cdot \nabla v = \int_{\Omega_i} fv \quad \forall~ v,~i=1,2. \end{aligned} \end{equation*}" src="form_243.png"/>
</p>
<h3><a class="anchor" id="Overlapping_Implementation"></a>
Implementation</h3>
<div class="fragment"><div class="line"><span class="comment">//  Implementation of the local problem</span></div>
<div class="line"><span class="keyword">template</span>&lt;Expr&gt;</div>
<div class="line"><span class="keywordtype">void</span></div>
<div class="line">localProblem(element_type&amp; u, Expr expr)</div>
<div class="line">{</div>
<div class="line"> <span class="comment">// Assembly of the right hand side $ \mathlarger \int_\Omega fv $</span></div>
<div class="line">    <span class="keyword">auto</span> F = M_backend-&gt;newVector(Xh);</div>
<div class="line">    form1( _test=Xh,_vector=F, _init=<span class="keyword">true</span> ) =</div>
<div class="line">           <a class="code" href="namespaceFeel.html#a4c300b4c137594540a9428af36363049" title="integrate a polynomial over a convex ">integrate</a>( <a class="code" href="namespaceFeel.html#ace44a7a9c428a5849b81de59532e4ef8">elements</a>(mesh), f*<span class="keywordtype">id</span>(v) );</div>
<div class="line">    F-&gt;close();</div>
<div class="line">                                       </div>
<div class="line"> <span class="comment">// Assembly of the left hand side $ \mathlarger \int_\Omega \nabla u \cdot  \nabla v$</span></div>
<div class="line">    <span class="keyword">auto</span> A = M_backend-&gt;newMatrix( Xh, Xh );</div>
<div class="line">    form2( _test=Xh, _trial=Xh, _matrix=A, _init=<span class="keyword">true</span> ) =</div>
<div class="line">           <a class="code" href="namespaceFeel.html#a4c300b4c137594540a9428af36363049" title="integrate a polynomial over a convex ">integrate</a>( <a class="code" href="namespaceFeel.html#ace44a7a9c428a5849b81de59532e4ef8">elements</a>(mesh), gradt(u)*trans(grad(v)) );</div>
<div class="line">    A-&gt;close();</div>
<div class="line">                                    </div>
<div class="line"> <span class="comment">// Apply the dirichlet boundary conditions</span></div>
<div class="line">    form2( Xh, Xh, A ) +=</div>
<div class="line">           on( <a class="code" href="namespaceFeel.html#ac0d40e0852d5f0d447623caff773b1a5">markedfaces</a>(mesh, <span class="stringliteral">&quot;Dirichlet&quot;</span>) ,u,F,g);</div>
<div class="line">                                    </div>
<div class="line"> <span class="comment">// Apply the dirichlet interface conditions</span></div>
<div class="line">    form2( Xh, Xh, A ) +=</div>
<div class="line">           on( <a class="code" href="namespaceFeel.html#ac0d40e0852d5f0d447623caff773b1a5">markedfaces</a>(mesh, <span class="stringliteral">&quot;Interface&quot;</span>) ,u,F,expr);</div>
<div class="line">                                    </div>
<div class="line"> <span class="comment">// solve the linear system $ A u = F $</span></div>
<div class="line">    M_backend-&gt;solve(_matrix=A, _solution=u, _rhs=F );</div>
<div class="line">}</div>
<div class="line">                                    </div>
<div class="line">  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cpt = 0;</div>
<div class="line">  <span class="keywordtype">double</span> tolerance = $1e-8$;</div>
<div class="line">  <span class="keywordtype">double</span> maxIterations = 20;</div>
<div class="line">  <span class="keywordtype">double</span> l2erroru$_1$ = 1.;</div>
<div class="line">  <span class="keywordtype">double</span> l2erroru$_2$ = 1;</div>
<div class="line">                                    </div>
<div class="line"> <span class="comment">// Iteration loop</span></div>
<div class="line">                                    </div>
<div class="line">  <span class="keywordflow">while</span>( (l2erroru$_1$ +l2erroru$_2$) &gt; tolerance &amp;&amp; cpt &lt;= maxIterations)</div>
<div class="line">  {</div>
<div class="line">                                    </div>
<div class="line">    <span class="comment">// call the localProblem on the first subdomain $\Omega_1$</span></div>
<div class="line">       localProblem(u$_1$, idv(u$_2$));</div>
<div class="line">                                    </div>
<div class="line">    <span class="comment">// call the localProblem on the first subdomain $\Omega_2$</span></div>
<div class="line">       localProblem(u$_2$, idv(u$_1$));</div>
<div class="line">                                    </div>
<div class="line">    <span class="comment">// compute L2 errors on each subdomain</span></div>
<div class="line">       L2erroru$_1$ = l2Error(u$_1$);</div>
<div class="line">       L2erroru$_2$ = l2Error(u$_2$);</div>
<div class="line">                                    </div>
<div class="line">    <span class="comment">// increment the cunter</span></div>
<div class="line">        ++cpt;</div>
<div class="line">  }</div>
</div><!-- fragment --><h2><a class="anchor" id="Overlapping_Numerical"></a>
Numerical results in 2D case</h2>
<p>The numerical results presented in the following table correspond to the partition of the global domain <img class="formulaInl" alt="$\Omega$" src="form_210.png"/> in two subdomains <img class="formulaInl" alt="$\Omega_1$" src="form_240.png"/> and <img class="formulaInl" alt="$\Omega_2$" src="form_241.png"/> and the following configuration: </p>
<ul>
<li><img class="formulaInl" alt="$ g(x,y) = \sin(\pi x)\cos(\pi y)$" src="form_244.png"/> : the exact solution </li>
<li><img class="formulaInl" alt="$f(x,y) = 2\pi^2g$" src="form_245.png"/> : the right hand side of the equation </li>
<li><img class="formulaInl" alt="$\mathbb P_2$" src="form_246.png"/> approximation : the lagrange polynomial order </li>
<li>hsize <img class="formulaInl" alt="$= 0.02$" src="form_247.png"/> : the mesh size </li>
<li>tol <img class="formulaInl" alt="$=1e-9$" src="form_248.png"/> : the tolerance</li>
</ul>
<center> <table  border="0px">
<tr>
<td><div class="image">
<img src="dd2dgeometry.png" alt="dd2dgeometry.png"/>
</div>
 </td><td><div class="image">
<img src="dd2dmesh.png" alt="dd2dmesh.png"/>
</div>
  </td></tr>
<tr>
<td><center>Two overlapping subdomains</center> </td><td><center>Two overlapping meshes</center>  </td></tr>
<tr>
<th align="center" colspan="2">Geometry  </th></tr>
</table>
</center><table  class="manual">
<tr>
<th>Nomber of iterations</th><td><img class="formulaInl" alt="$\mathbf {\| u_1-u_{ex}\|_{L_2} }$" src="form_249.png"/></td><td><img class="formulaInl" alt="$\mathbf{\| u_2-u_{ex}\|_{L_2}}$" src="form_250.png"/>  </td></tr>
<tr>
<td>11 </td><td>2.52e-8 </td><td>2.16e-8   </td></tr>
</table>
<h2><a class="anchor" id="Overlapping_Solutions"></a>
Numerical Solutions in 2D Case</h2>
<center> <table  border="0px">
<tr>
<td><div class="image">
<img src="iter_1.png" alt="iter_1.png"/>
</div>
 </td><td><div class="image">
<img src="iter_10.png" alt="iter_10.png"/>
</div>
  </td></tr>
<tr>
<td><center>First <a class="el" href="classFeel_1_1Iteration.html" title="brief description ">Iteration</a></center> </td><td><center> <img class="formulaInl" alt="$ 10^{th}$" src="form_251.png"/> <a class="el" href="classFeel_1_1Iteration.html" title="brief description ">Iteration</a></center>  </td></tr>
<tr>
<th align="center" colspan="2">Isovalues of Solution in 2D  </th></tr>
</table>
</center><h1><a class="anchor" id="Computing"></a>
Computing the eigenmodes of the Dirichlet to Neumann operator</h1>
<h2><a class="anchor" id="Computing_Description"></a>
Problem description and variational formulation</h2>
<p>We consider at the continuous level the Dirichlet-to-Neumann(DtN) map on <img class="formulaInl" alt="$\Omega$" src="form_210.png"/>, denoted by DtN <img class="formulaInl" alt="$_{\Omega}$" src="form_252.png"/>. Let <img class="formulaInl" alt="$u: \Gamma \longmapsto \mathbb R, $" src="form_253.png"/> </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation*} \label{eq:35} \text{DtN}_{\Omega}(u) = \kappa \frac{\partial v}{ n} \Big |_{\Gamma} \end{equation*} where $v$ satisfies \begin{equation} \label{eq:36} \left\{ \begin{aligned} &amp; \mathcal L(v):= (\eta - \text{div}(\kappa \nabla))v = 0 &amp; \text{dans} \quad \Omega,\\ &amp; v = u &amp; \text{sur} \quad \Gamma \end{aligned} \right. \end{equation*}" src="form_254.png"/>
</p>
<p>where <img class="formulaInl" alt="$\Omega$" src="form_210.png"/> is a bounded domain of <img class="formulaInl" alt="$\mathbb R^d$" src="form_255.png"/> (d=2 or 3), and <img class="formulaInl" alt="$\Gamma$" src="form_212.png"/> it border, <img class="formulaInl" alt="$\kappa$" src="form_256.png"/> is a positive diffusion function which can be discontinuous, and <img class="formulaInl" alt="$\eta \geq 0$" src="form_257.png"/>. The eigenmodes of the Dirichlet-to-Neumann operator are solutions of the following eigenvalues problem </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:37} \text{DtN}_{\Omega}(u) = \lambda \kappa u \end{equation}" src="form_258.png"/>
</p>
<p>To obtain the discrete form of the DtN map, we consider the variational form of <img class="formulaInl" alt="$(1)$" src="form_259.png"/>. let's define the bilinear form <img class="formulaInl" alt="$a : H^1(\Omega) \times H^1(\Omega) \longrightarrow \mathbb R $" src="form_260.png"/>, </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation*} \label{eq:41} a(w,v) := \int_\Omega \eta w v + \kappa \nabla w \cdot \nabla v . \end{equation*}" src="form_261.png"/>
</p>
<p>With a finite element basis <img class="formulaInl" alt="$\{ \phi_k \}$" src="form_262.png"/>, the coefficient matrix of a Neumann boundary value problem in <img class="formulaInl" alt="$\Omega$" src="form_210.png"/> is </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation*} \label{eq:42} A_{kl} := \int_\Omega \eta \phi_k \phi_l + \kappa \nabla \phi_k \cdot \nabla \phi_l . \end{equation*}" src="form_263.png"/>
</p>
<p>A variational formulation of the flux reads </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation*} \label{eq:43} \int_\Gamma \kappa \dfrac{\partial v}{\partial n} \phi_k = \int_\Omega \eta v \phi_k + \kappa \nabla v \cdot \nabla \phi_k \quad \forall~ \phi_k. \end{equation*}" src="form_264.png"/>
</p>
<p>So the variational formulation of the eigenvalue problem <img class="formulaInl" alt="$(2)$" src="form_265.png"/> reads </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:40} \int_\Omega \eta v \phi_k + \kappa \nabla v \cdot \nabla \phi_k = \lambda \int_\Gamma \kappa v \phi_k \quad \forall~ \phi_k. \end{equation}" src="form_266.png"/>
</p>
<p>Let <img class="formulaInl" alt="$B$" src="form_267.png"/> be the weighted mass matrix </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation*} \label{eq:44} (B)_{kl} = \int_\Gamma \kappa \phi_k \phi_l \end{equation*}" src="form_268.png"/>
</p>
<p>The compact form of <img class="formulaInl" alt="$(3)$" src="form_269.png"/> is </p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\begin{equation} \label{eq:45} Av = \lambda B v \end{equation}" src="form_270.png"/>
</p>
<h2><a class="anchor" id="Computing_Implementation"></a>
Implementation</h2>
<p>Assembly of the right hand side <img class="formulaInl" alt="$ B = \mathlarger \int_\Gamma \kappa v w $" src="form_271.png"/> </p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> B = M_backend-&gt;newMatrix( Xh, Xh ) ;</div>
<div class="line">form2( _test=Xh, _trial=Xh, _matrix=B, _init=<span class="keyword">true</span> );</div>
<div class="line">BOOST_FOREACH( <span class="keywordtype">int</span> marker, flags )</div>
<div class="line">{</div>
<div class="line">  form2( Xh, Xh, B ) +=</div>
<div class="line">  <a class="code" href="namespaceFeel.html#a4c300b4c137594540a9428af36363049" title="integrate a polynomial over a convex ">integrate</a>( <a class="code" href="namespaceFeel.html#ac0d40e0852d5f0d447623caff773b1a5">markedfaces</a>(mesh,marker), kappa*idt(u)*<span class="keywordtype">id</span>(v) );</div>
<div class="line">}</div>
<div class="line">B-&gt;close();</div>
</div><!-- fragment --><p> Assembly of the left hand side <img class="formulaInl" alt="$ A = \mathlarger \int_\Omega \eta v w + \kappa \nabla v \cdot \nabla w $" src="form_272.png"/> </p>
<div class="fragment"><div class="line"> <span class="keyword">auto</span> A = M_backend-&gt;newMatrix( Xh, Xh ) ;</div>
<div class="line"> form2( _test=Xh, _trial=Xh, _matrix=A, _init=<span class="keyword">true</span> ) =</div>
<div class="line"> <a class="code" href="namespaceFeel.html#a4c300b4c137594540a9428af36363049" title="integrate a polynomial over a convex ">integrate</a>( <a class="code" href="namespaceFeel.html#ace44a7a9c428a5849b81de59532e4ef8">elements</a>(mesh), kappa*gradt(u)*trans(grad(v)) + nu*idt(u)*<span class="keywordtype">id</span>(v) );</div>
<div class="line"> A-&gt;close();</div>
<div class="line">                     </div>
<div class="line"><span class="comment">// eigenvalue solver options</span></div>
<div class="line"> <span class="keywordtype">int</span> nev = this-&gt;vm()[<span class="stringliteral">&quot;solvereigen-nev&quot;</span>].template as&lt;int&gt;();</div>
<div class="line"> <span class="keywordtype">int</span> ncv = this-&gt;vm()[<span class="stringliteral">&quot;solvereigen-ncv&quot;</span>].template as&lt;int&gt;();;</div>
<div class="line"><span class="comment">// definition of the eigenmodes</span></div>
<div class="line"> SolverEigen&lt;double&gt;::eigenmodes_type modes;</div>
</div><!-- fragment --><p> solve the eigenvalue problem <img class="formulaInl" alt="$ Av = \lambda B v $" src="form_273.png"/> </p>
<div class="fragment"><div class="line"> modes=</div>
<div class="line">       eigs( _matrixA=A,</div>
<div class="line">             _matrixB=B,</div>
<div class="line">             _nev=nev,</div>
<div class="line">             _ncv=ncv,</div>
<div class="line">             _transform=SINVERT,</div>
<div class="line">             _spectrum=SMALLEST_MAGNITUDE,</div>
<div class="line">             _verbose = <span class="keyword">true</span> );</div>
<div class="line">                                            </div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="Computing_Solutions"></a>
Numerical solutions</h2>
<center> <table  border="0px">
<tr>
<td><div class="image">
<img src="mode-0.png" alt="mode-0.png"/>
</div>
 </td><td><div class="image">
<img src="mode-1.png" alt="mode-1.png"/>
</div>
 </td><td><div class="image">
<img src="mode-2.png" alt="mode-2.png"/>
</div>
  </td></tr>
<tr>
<td><center>first mode</center> </td><td><center>second mode</center> </td><td><center>third mode</center>  </td></tr>
<tr>
<th align="center" colspan="3">Three eigenmodes  </th></tr>
</table>
</center><p>These numerical solutions correspond to the following configuration : </p>
<ul>
<li><img class="formulaInl" alt="$\mathbb P_2$" src="form_246.png"/> approximation : the lagrange polynomial order </li>
<li>hsize <img class="formulaInl" alt="$= 0.02$" src="form_247.png"/> : the mesh size </li>
<li><img class="formulaInl" alt="$\mu = \kappa = 1.$" src="form_274.png"/> </li>
</ul>
</div></div><!-- contents -->
</div><!-- doc-content -->
<hr size="1"><address style="text-align: right;"><small>
Generated on Fri Nov 1 2013 00:01:17 for Feel++ by&nbsp;<a href="http://www.doxygen.org/index.html"><img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.8.4</small></address>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-40726726-1', 'github.io');
  ga('send', 'pageview');
</script>
</body>
</html>
